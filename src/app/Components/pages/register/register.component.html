<div class="register-container">
  <mat-card class="register-card">
    <div class="celebration-container">
      <span class="btn-text">
        ‡¶∞‡ßá‡¶ú‡¶ø‡¶∏‡ßç‡¶ü‡ßç‡¶∞‡ßá‡¶∂‡¶® ‡¶´‡¶∞‡ßç‡¶Æ
      </span>
      <div class="accent-bar"></div>
      <p class="form-hint">
        ‚Äú‡¶Ö‡¶¨‡¶∂‡ßç‡¶Ø‡¶á, ‡¶∏‡¶ï‡¶≤ ‡¶§‡¶•‡ßç‡¶Ø ‡¶á‡¶Ç‡¶∞‡ßá‡¶ú‡¶ø‡¶§‡ßá ‡¶¶‡¶ø‡¶¨‡ßá‡¶®‡•§‚Äù

      </p>
    </div>



    <form [formGroup]="form" (ngSubmit)="onSubmit()">
      <div class="form-group">
        <!-- Education Records -->

        <!-- Full Name -->
        <mat-form-field appearance="outline" class="flex-field">
          <mat-label>Full Name</mat-label>
          <input matInput formControlName="fullName" required />
          <mat-error *ngIf="form.controls['fullName'].invalid && form.controls['fullName'].touched">
            Full Name is required
          </mat-error>
        </mat-form-field>
        <!-- Blood Group -->
        <mat-form-field appearance="outline" class="flex-field">
          <mat-label>Blood Group</mat-label>
          <mat-select formControlName="bloodGroup" required>
            <mat-option value="">-- Select --</mat-option>
            <mat-option *ngFor="let group of bloodGroups" [value]="group">
              {{ group }}
            </mat-option>
          </mat-select>
          <mat-error *ngIf="form.controls['bloodGroup'].invalid && form.controls['bloodGroup'].touched">
            Blood Group is required
          </mat-error>
        </mat-form-field>

        <!-- Email -->
        <mat-form-field appearance="outline" class="flex-field">
          <mat-label>Email</mat-label>
          <input matInput type="email" formControlName="email" required />
          <mat-error *ngIf="form.controls['email'].invalid && form.controls['email'].touched">
            Valid Email is required
          </mat-error>
        </mat-form-field>
        <!-- Phone -->
        <mat-form-field appearance="outline" class="flex-field">
          <mat-label>Phone Number</mat-label>
          <input matInput formControlName="phone" placeholder="019xxxxxxxx" required />
          <mat-error *ngIf="form.controls['phone'].invalid && form.controls['phone'].touched">
            Phone Number is required
          </mat-error>
        </mat-form-field>

        <!-- Gender -->
        <mat-form-field appearance="outline" class="flex-field">
          <mat-label>Gender</mat-label>
          <mat-select formControlName="gender" required>
            <mat-option value="" disabled>Select One</mat-option>
            <mat-option value="Male">Male</mat-option>
            <mat-option value="Female">Female</mat-option>
            <mat-option value="Others">I don't want to¬†disclose</mat-option>
          </mat-select>
        </mat-form-field>


        <!-- Batch -->
        <mat-form-field appearance="outline" class="flex-field">
          <mat-label>SSC Batch (Passing Year)</mat-label>
          <mat-select formControlName="batch" required>

            <!-- CORRECT: ngx-mat-select-search must be inside a disabled mat-option -->
            <!-- <mat-option disabled>
              <ngx-mat-select-search [formControl]="batchFilterCtrl" placeholderLabel="Search..."
                noEntriesFoundLabel="No results found"></ngx-mat-select-search>
            </mat-option> -->

            <!-- Filtered options -->
            <mat-option value="">-- Select --</mat-option>
            <mat-option *ngFor="let batch of filteredBatches | async" [value]="batch">
              {{ batch }}
            </mat-option>

          </mat-select>
        </mat-form-field>





        <!-- Current Designation -->
        <mat-form-field appearance="outline" class="flex-field">
          <mat-label>Current Designation</mat-label>
          <input matInput formControlName="currentDesignation" />
        </mat-form-field>

        <!-- Company/Institute -->
        <mat-form-field appearance="outline" class="flex-field">
          <mat-label>Company / Institute</mat-label>
          <input matInput formControlName="employer" />
        </mat-form-field>

        <!-- Current City -->
        <mat-form-field appearance="outline" class="flex-field">
          <mat-label>Current City</mat-label>
          <input matInput formControlName="currentCity" />
        </mat-form-field>

        <!-- Date of Birth -->
        <mat-form-field appearance="outline" class="flex-field" (click)="picker.open()">
          <mat-label>Date of Birth</mat-label>
          <input matInput [matDatepicker]="picker" formControlName="dob" placeholder="Choose a date" readonly
            (click)="$event.stopPropagation()" />
          <mat-datepicker-toggle matSuffix [for]="picker"></mat-datepicker-toggle>
          <mat-datepicker #picker></mat-datepicker>
          <mat-hint *ngIf="!form.controls['dob'].value">
            üéâ Share your DOB for a wish from us!
          </mat-hint>
        </mat-form-field>

      </div>

      <!-- Education Records -->

      <h3 class="section-title">Education Records</h3>
      <p class="education-instruction">
        ‡¶ö‡¶≤‡¶Æ‡¶æ‡¶® ‡¶¨‡¶æ ‡¶∏‡¶Æ‡ßç‡¶™‡¶®‡ßç‡¶® ‡¶°‡¶ø‡¶ó‡ßç‡¶∞‡ßÄ‡¶ó‡ßÅ‡¶≤‡ßã ‡¶ü‡¶ø‡¶ï(‚úîÔ∏è)‡¶¶‡¶ø‡ßü‡ßá ‡¶â‡¶≤‡ßç‡¶≤‡ßá‡¶ñ ‡¶ï‡¶∞‡ßÅ‡¶®‡•§
      </p>
      <div formArrayName="educationRecords" class="education-section">
        <div *ngFor="let eduCtrl of educationRecords.controls; let i = index" [formGroupName]="i" class="education-row">

          <!-- Checkbox -->
          <mat-checkbox formControlName="isCompleted" class="edu-checkbox">
            {{ eduCtrl.value.degreeName }}
          </mat-checkbox>

          <!-- Institute / College / University -->
          <mat-form-field appearance="outline" class="edu-input">
            <mat-label>Institute / College / University</mat-label>
            <input matInput formControlName="instituteName">
          </mat-form-field>

          <!-- Subject -->
          <mat-form-field appearance="outline" class="edu-input">
            <mat-label>Subject / Group</mat-label>
            <input matInput formControlName="subject">
          </mat-form-field>

        </div>
      </div>


      <h3 class="section-title">Member Fees</h3>
      <!-- Registration Fee Section -->
      <div class="fee-info-box">
        <p>
          ‡¶§‡¶•‡ßç‡¶Ø‡¶ó‡ßÅ‡¶≤‡ßã ‡¶∏‡¶æ‡¶¨‡¶Æ‡¶ø‡¶ü ‡¶ï‡¶∞‡¶æ‡¶∞ ‡¶™‡¶∞ ‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶¨‡ßç‡¶Ø‡¶æ‡¶ö ‡¶è‡¶∞ ‡¶¨‡ßç‡¶Ø‡¶æ‡¶ö ‡¶∞‡¶ø‡¶™‡ßç‡¶∞‡ßá‡¶ú‡ßá‡¶®‡ßç‡¶ü‡ßá‡¶ü‡¶ø‡¶≠ ‡¶è‡¶∞ ‡¶ï‡¶æ‡¶õ‡ßá ‡¶∞‡ßá‡¶ú‡¶ø‡¶∏‡ßç‡¶ü‡ßç‡¶∞‡ßá‡¶∂‡¶® ‡¶´‡ßÄ ‡¶ú‡¶Æ‡¶æ ‡¶ï‡¶∞‡ßá ‡¶∞‡ßá‡¶ú‡¶ø‡¶∏‡ßç‡¶ü‡ßç‡¶∞‡ßá‡¶∂‡¶®
          ‡¶∏‡¶Æ‡ßç‡¶™‡¶®‡ßç‡¶® ‡¶ï‡¶∞‡ßÅ‡¶®‡•§
        </p>

        <p>
          ‡¶è‡¶ï‡ßç‡¶∑‡ßá‡¶§‡ßç‡¶∞‡ßá ‡¶â‡¶≤‡ßç‡¶≤‡ßá‡¶ñ‡ßç‡¶Ø ‡¶Ø‡ßá, ‡¶Æ‡ßã‡¶∏‡ßç‡¶ü ‡¶ú‡ßÅ‡¶®‡¶ø‡ßü‡¶∞ ‡¶™‡ßç‡¶∞‡¶æ‡ßü ‡ßÆ/‡ßß‡ß¶ ‡¶ü‡¶ø ‡¶¨‡ßç‡¶Ø‡¶æ‡¶ö, ‡¶Ø‡¶æ‡¶∞‡¶æ ‡¶è‡¶ñ‡¶®‡¶ì ‡¶™‡ßú‡¶æ‡¶∂‡ßã‡¶®‡¶æ‡¶∞ ‡¶∏‡¶æ‡¶•‡ßá ‡¶ú‡ßú‡¶ø‡¶§ ‡¶Ü‡¶õ‡ßá‡¶® ‡¶¨‡¶æ ‡¶ö‡¶æ‡¶ï‡ßÅ‡¶∞‡ßÄ ‡¶ú‡¶®‡ßç‡¶Ø
          ‡¶™‡ßú‡¶æ‡¶∂‡ßã‡¶®‡¶æ ‡¶ï‡¶∞‡¶õ‡ßá‡¶® ‡¶∏‡¶¨‡¶æ‡¶∞ ‡¶ï‡¶•‡¶æ ‡¶Æ‡¶æ‡¶•‡¶æ‡ßü ‡¶∞‡ßá‡¶ñ‡ßá UPSAA ‡¶è‡¶∞ ‡¶∏‡¶¶‡¶∏‡ßç‡¶Ø ‡¶´‡¶ø ‡¶®‡¶ø‡¶∞‡ßç‡¶ß‡¶æ‡¶∞‡¶ø‡¶§ ‡¶π‡ßü‡ßá‡¶õ‡ßá‡•§
        </p>

        <ul>
          <li>‡¶∏‡¶¶‡¶∏‡ßç‡¶Ø ‡¶´‡¶ø‡¶É ‡ßß‡ß¶‡ß¶ ‡¶ü‡¶æ‡¶ï‡¶æ</li>
          <li>‡¶¨‡¶æ‡ßé‡¶∏‡¶∞‡¶ø‡¶ï ‡¶´‡¶ø‡¶É ‡ß©‡ß¶‡ß¶ ‡¶ü‡¶æ‡¶ï‡¶æ</li>
        </ul>

        <p>
          ‡¶§‡¶¨‡ßá ‡¶è‡¶á ‡¶∏‡ßÅ‡¶¶‡ßÇ‡¶∞‡¶™‡ßç‡¶∞‡¶∏‡¶æ‡¶∞‡ßÄ ‡¶∏‡¶Ç‡¶ó‡¶†‡¶®‡ßá‡¶∞ ‡¶∏‡¶ï‡¶≤ ‡¶ï‡¶æ‡¶∞‡ßç‡¶Ø‡¶ï‡ßç‡¶∞‡¶Æ ‡¶™‡¶∞‡¶ø‡¶ö‡¶æ‡¶≤‡¶®‡¶æ ‡¶è‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø ‡¶è‡¶á ‡¶´‡¶æ‡¶®‡ßç‡¶° ‡¶Ø‡¶•‡ßá‡¶∑‡ßç‡¶ü ‡¶®‡ßü ‡¶è‡¶¨‡¶Ç ‡¶è‡¶á ‡¶Ö‡¶¨‡¶∏‡ßç‡¶•‡¶æ‡ßü ‡¶è‡¶ó‡¶ø‡ßü‡ßá ‡¶Ü‡¶∏‡¶§‡ßá ‡¶π‡¶¨‡ßá
          ‡¶Ü‡¶Æ‡¶æ‡¶¶‡ßá‡¶∞‡¶ï‡ßá‡¶á‡•§
          ‡¶è‡¶á ‡¶ú‡¶®‡ßç‡¶Ø ‡¶è‡¶ñ‡¶æ‡¶®‡ßá ‡ßß‡ß¶‡ß¶ ‡¶ü‡¶æ‡¶ï‡¶æ ‡¶´‡¶ø ‡¶è‡¶∞ ‡¶™‡¶æ‡¶∂‡¶æ‡¶™‡¶æ‡¶∂‡¶ø ‡¶è‡¶ï‡¶ü‡¶ø ‡¶Ö‡¶®‡ßÅ‡¶¶‡¶æ‡¶® ‡¶™‡ßç‡¶∞‡¶¶‡¶æ‡¶®‡ßá‡¶∞ ‡¶∏‡ßÅ‡¶Ø‡ßã‡¶ó ‡¶∞‡¶æ‡¶ñ‡¶æ ‡¶π‡ßü‡ßá‡¶õ‡ßá‡•§
          ‡¶∏‡¶¶‡¶∏‡ßç‡¶Ø‡¶ó‡¶£ ‡¶Ø‡¶æ‡¶∞ ‡¶Ø‡¶æ‡¶∞ ‡¶Ü‡¶∞‡ßç‡¶•‡¶ø‡¶ï ‡¶Ö‡¶¨‡¶∏‡ßç‡¶•‡¶æ‡¶® ‡¶•‡ßá‡¶ï‡ßá ‡¶∏‡ßç‡¶¨‡ßá‡¶ö‡ßç‡¶õ‡¶æ‡ßü ‡¶Ø‡ßá‡¶ï‡ßã‡¶®‡ßã ‡¶™‡¶∞‡¶ø‡¶Æ‡¶æ‡¶® ‡¶Ö‡¶®‡ßÅ‡¶¶‡¶æ‡¶® ‡¶™‡ßç‡¶∞‡¶¶‡¶æ‡¶® ‡¶ï‡¶∞‡¶¨‡ßá‡¶® ‡¶è‡¶á ‡¶™‡ßç‡¶∞‡¶§‡ßç‡¶Ø‡¶æ‡¶∂‡¶æ ‡¶•‡¶æ‡¶ï‡¶¨‡ßá‡•§
        </p>
      </div>


      <div class="fee-amount-box">
        <div formArrayName="memberFees" class="fees-invoice">
          <div class="invoice-header">
            <div class="header-type">Fee Type</div>
            <div class="header-amount">Amount (BDT)</div>
          </div>

          <div *ngFor="let feeCtrl of memberFees.controls; let i = index" [formGroupName]="i" class="fee-row"
            [ngClass]="{'odd-row': i % 2 === 0, 'even-row': i % 2 !== 0}">
            <div class="fee-type">{{ feeCtrl.value.feeType }}</div>
            <div class="fee-amount-wrapper">
              <span *ngIf="feeCtrl.value.feeType !== 'Donation'" class="fixed-amount">
                {{ feeCtrl.value.amount }}
              </span>
              <mat-form-field *ngIf="feeCtrl.value.feeType === 'Donation'" appearance="outline" class="fee-amount">
                <mat-label>Amount</mat-label>
                <input matInput type="number" formControlName="amount" placeholder="Amount">
              </mat-form-field>
            </div>
          </div>

          <div class="invoice-total">
            <div class="total-label">Total</div>
            <div class="total-amount">
              {{ totalAmount | currency:'BDT':'symbol' }}
            </div>
          </div>
        </div>
      </div>




      <!-- Submit Button -->
      <button mat-raised-button color="primary" class="submit-btn" [disabled]="form.invalid || isSubmitting">
        Submit
      </button>
    </form>
  </mat-card>
</div>