<div class="page-wrapper">
  <div class="form-container">

    <!-- Success Message -->
    <div *ngIf="step === 4" class="success-step">
      <h2>Password Reset Successful âœ…</h2>
      <p>Your password has been updated successfully.</p>
      <a class="btn-link" routerLink="/login">Go to Login</a>
    </div>

    <!-- Steps 1-3 -->
    <ng-container *ngIf="step < 4">

      <h2>Forgot Password</h2>

      <!-- Step Progress Bar -->
      <div class="progress-bar">
        <div class="progress-step" [ngClass]="{ active: step >= 1 }">1</div>
        <div class="progress-step" [ngClass]="{ active: step >= 2 }">2</div>
        <div class="progress-step" [ngClass]="{ active: step >= 3 }">3</div>
      </div>

      <div class="step-indicator">
        Step {{ step }} of 3
      </div>

      <!-- Step 1: Phone + Batch -->
      <div *ngIf="step === 1" class="step">
        <input type="text" [(ngModel)]="phoneNumber" placeholder="Registered Phone Number" class="input-field" />
        <select [(ngModel)]="batch" class="input-field">
          <option value="">Select Your Batch</option>
          <option *ngFor="let year of batchYears" [value]="year">{{ year }}</option>
        </select>
        <button class="btn" (click)="sendOtp()" [disabled]="!phoneNumber || !batch || loading">
          {{ loading ? 'Sending...' : 'Send OTP' }}
        </button>
      </div>

      <!-- Step 2: OTP Verification -->
      <div *ngIf="step === 2" class="step">
        <input type="text" maxlength="6" [(ngModel)]="otp" placeholder="Enter 6-digit OTP" class="input-field" />
        <button class="btn" (click)="verifyOtp()" [disabled]="otp.length !== 6 || loading">
          {{ loading ? 'Verifying...' : 'Verify OTP' }}
        </button>

        <div *ngIf="otpCountdown > 0" class="otp-countdown">
          Resend OTP in {{ otpCountdown }}s
        </div>
        <button *ngIf="otpCountdown <= 0" class="btn-link" (click)="resendOtp()">Resend OTP</button>
      </div>

      <!-- Step 3: Reset Password -->
      <div *ngIf="step === 3" class="step">
        <input type="password" [(ngModel)]="newPassword" placeholder="New Password" class="input-field" />
        <input type="password" [(ngModel)]="confirmPassword" placeholder="Confirm Password" class="input-field" />
        <button class="btn" (click)="resetPassword()"
          [disabled]="!newPassword || newPassword !== confirmPassword || loading">
          {{ loading ? 'Resetting...' : 'Reset Password' }}
        </button>
      </div>

      <!-- Error / Info Message -->
      <p class="message" [ngClass]="{ error: isError }">{{ message }}</p>

    </ng-container>

  </div>
</div>